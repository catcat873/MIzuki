---
import { getCollection } from "astro:content";
import PostCard from "@/components/PostCard.astro";
import MainGridLayout from "../layouts/MainGridLayout.astro";

const posts = (await getCollection("posts"))
	.filter((p) => !p.data.draft && (p.data.tags || []).includes("学习"))
	.sort((a, b) => b.data.published.getTime() - a.data.published.getTime());
---

<MainGridLayout title="学习文章" description="学习与实战笔记汇总">
	<!-- 导航栏 -->
	<div class="mb-6">
		<div class="flex flex-wrap gap-3 mb-4">
			<a href="/study" class="px-4 py-2 bg-[var(--primary)] text-white rounded-lg hover:bg-[var(--primary-hover)] transition-colors">
				全部文章
			</a>
			<a href="/study/frontend" class="px-4 py-2 bg-[var(--card-bg)] text-[var(--text-primary)] rounded-lg hover:bg-[var(--hover-bg)] transition-colors border border-[var(--border-color)]">
				前端学习
			</a>
			<a href="/study/backend" class="px-4 py-2 bg-[var(--card-bg)] text-[var(--text-primary)] rounded-lg hover:bg-[var(--hover-bg)] transition-colors border border-[var(--border-color)]">
				后端学习
			</a>
			<a href="/study/mysql" class="px-4 py-2 bg-[var(--card-bg)] text-[var(--text-primary)] rounded-lg hover:bg-[var(--hover-bg)] transition-colors border border-[var(--border-color)]">
				MySQL学习
			</a>
			<a href="/study/interview" class="px-4 py-2 bg-[var(--card-bg)] text-[var(--text-primary)] rounded-lg hover:bg-[var(--hover-bg)] transition-colors border border-[var(--border-color)]">
				面试题库
			</a>
		</div>
	</div>

	<div class="transition flex flex-col rounded-[var(--radius-large)] bg-[var(--card-bg)] py-1 md:py-0 md:bg-transparent md:gap-4 mb-4">
		{posts.map((entry, index) => (
			<PostCard
				entry={entry}
				title={entry.data.title}
				tags={entry.data.tags}
				category={entry.data.category}
				published={entry.data.published}
				updated={entry.data.updated}
				draft={entry.data.draft}
				url={`/posts/${entry.slug}/`}
				image={entry.data.image}
				description={entry.data.description}
				class:list="onload-animation"
				style={`animation-delay: calc(var(--content-delay) + ${(index + 1) * 50}ms);`}
			/>
		))}
		{posts.length === 0 && (
			<p class="p-6 text-center text-[var(--text-secondary)]">暂无带有“学习”标签的文章。</p>
		)}
	</div>
</MainGridLayout>
